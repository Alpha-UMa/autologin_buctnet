# CampusNetAutoAuth

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python Version](https://img.shields.io/badge/python-3.7%2B-blue)](Version)
[![Node.js 16+](https://img.shields.io/badge/node.js-16%2B-green)](https://nodejs.org/)

> 专为 BUCT network 设计的无感知认证工具，免去手动登录流程
<!--也许大改之后也能适配别的系统，但实在不值得-->

## 背景

传统的校园网登录流程繁琐而费时，简化操作可节约学生时间。

我校校园网采用了独特认证体系，传统一键登录脚本无法适配。

本项目通过逆向工程校园网认证协议，实现了真正的后台无感知认证。
<!--虽说校园网系统有自带的无感知认证，可使名单内MAC地址的设备直接完成认证。但现代设备都有随机MAC的功能，无感知认证只有无感知是真的 -->
<!--另一个理由是路由器认证。也许可以放到软路由上运行-->
## 特性

- **静默运行** - 尽量减少视觉干扰，仅保留必要通知
- **状态检测** - 网络状态识别（互联网/校园内网）
- **加密兼容** - 直接调用网站原有加密函数
- **重试机制** - 采用11×5s容错策略

## ⚠️ 架构变更说明

由于纯 Python 实现存在字符编码兼容等问题，新版现在会调用外部 js 处理

## 使用说明

### 前置要求

- Windows 10/11 系统
- Python 3.7+ 及 Node.js 16+环境
- 有效校园网账号

### 快速开始

1. 安装依赖
   - 安装 Nodejs
   - 安装 win10toast 库<!--或是删除 win10toast 相关内容-->
        ```bash
        pip install requests win10toast
        ```
2. 配置参数
```python
# 修改以下参数
# 用户登录凭证
username = 'username'  # 请修改为自己的账号
password = 'password'  # 请修改为自己的密码
```
3. 运行程序
```bash
python login.pyw
```

### 计划任务配置

推荐通过Windows任务计划实现程序自启动


- 触发器：工作站解锁时（可设为只在指定网络连接可用时启动）
- 操作：启动程序（填入程序路径）
- 勾选"如果任务失败，按以下频率重新启动"（建议间隔1分钟）

## 实现原理

### 核心技术

- 令牌请求：向设定的 api 发送请求获取 Token
- 加密引擎：通过 subprocess 调用 JS 加密
- 状态检查：多重网络状态检测
- 容错机制：快速重试以避开错误

### 认证流程
```mermaid
graph TD
    A[网络连接] --> B{校园网可达?}
    B -->|否| C[等待重试]
    B -->|是| D{互联网连通?}
    D -->|是| E[认证成功]
    D -->|否| F[获取动态Token]
    F --> J[调用子进程]
    J --> G[返回加密参数]
    G --> H[提交登录请求]
    H --> I{成功?}
    I -->|否| C
    I -->|是| E
```

## 局限性

- 网络环境 - 适用于直连校园网条件
- 场景限定 - 基于北化当前校园网认证系统设计
- 配置难度 - 依赖项增多，稍增加了配置操作
<!--不要再用'或是"之类的字符测试了，这点不会再优化兼容，**所以还请不要使用'或"**-->

## 贡献
<!--只能说如果有时间可能还会再修改吧-->

欢迎通过以下方式改进项目：
- 报告现存问题
- 优化加密算法
- 开发其他模块

## 作者

（排名不分先后）
- Chatgpt(4o/o3-mini)
项目分析理解以及 js 功能分析
- Claude(3.7 Sonnet)
js 加密算法部分修改
- DeepSeek(R1)
程序框架实现
- ()
框架设计 信息整合 测试修改

**免责声明**：本项目仅用于技术研究，请遵守校园网使用规定。开发者不对其产生的后果负责。

<!--实际上短期频繁登录会被阻止，所以应该不会有爆破风险什么的？-->
